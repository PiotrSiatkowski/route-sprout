"use strict";var h=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var $=Object.getOwnPropertyNames;var w=Object.prototype.hasOwnProperty;var x=(e,t)=>{for(var s in t)h(e,s,{get:t[s],enumerable:!0})},N=(e,t,s,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of $(t))!w.call(e,o)&&o!==s&&h(e,o,{get:()=>t[o],enumerable:!(a=y(t,o))||a.enumerable});return e};var D=e=>N(h({},"__esModule",{value:!0}),e);var E={};x(E,{base:()=>A,keep:()=>L,path:()=>u,pick:()=>j,root:()=>T,slot:()=>P,wrap:()=>C});module.exports=D(E);var p=e=>e.replace(/^-+/,"").replace(/-+$/,"").replace(/^_+/,"").replace(/_+$/,"").replace(/-([a-zA-Z0-9])/g,(t,s)=>s.toUpperCase()).replace(/_([a-zA-Z0-9])/g,(t,s)=>s.toUpperCase()),b=/^[A-Za-z_-][A-Za-z0-9_-]*$/;function g(e,t){if(e==="path"&&t==="")return t.trim();if(!t)throw new Error(`${e} name cannot be empty`);if(!b.test(t))throw new Error(`${e} name "${t}" must be a valid identifier (letters/digits/_/$, not starting with a digit).`);return t.trim()}var S=e=>Array.isArray(e)?e:[e],L=()=>({kind:"keep"}),u=(e,t)=>({kind:"path",name:g("path",e),uuid:p(e),list:t??[]}),P=(e,t)=>({kind:"slot",name:g("slot",e),uuid:`$${p(e)}`,list:t??[]}),C=(e,t,s)=>({kind:"wrap",name:g("wrap",e),uuid:`$${p(e)}`,when:t,list:s??[]}),j=(e,t,s)=>({kind:"pick",name:g("pick",e),uuid:`$${p(e)}`,mode:t,list:s??[]}),A=(e,t)=>({kind:"base",segs:e,list:t??[]}),T=e=>l([],u("",e)),_=(e,t)=>`/${e.filter(Boolean).join("/").replace(/\/{2,}/g,"/")}${t?`?${t}`:""}`;function l(e,t){let s=n=>n.list.some(i=>i.kind==="keep"),a=t.kind==="path"&&t.name?[...e,t.name]:e,o=c(s(t),a);for(let n of t.list){if(n.kind!=="keep"&&n.uuid in o)throw new Error(`Duplicate uuid "${String(n.uuid)}" under "${a.join("/")||"/"}"`);if(n.kind==="base"){let i=[...a,...S(n.segs)],d=l(i,u("",n.list));for(let r of Reflect.ownKeys(d)){if(r==="$when"||r==="$join")continue;let m=Object.getOwnPropertyDescriptor(d,r);if(m?.enumerable){if(r in o)throw new Error(`base() merge collision on key "${String(r)}" under "${a.join("/")||"/"}"`);Object.defineProperty(o,r,m)}}}else if(n.kind==="slot")o[n.uuid]=function(d){let r=[...a,d];return n.list.length===0?f(c(!0,r),r,[]):Object.assign(c(s(n),r),l(r,n))};else if(n.kind==="path")if(n.list.length===0){let i=[...a,n.name];o[n.uuid]=f(c(!0,i),i,[])}else o[n.uuid]=l(a,n);else n.kind==="wrap"?o[n.uuid]=function(d){let m=n.when(d)?[...a,n.name]:a,k=l(m,n);return Object.assign(c(s(n),m),k)}:n.kind==="pick"&&(o[n.uuid]=i=>{if(n.mode[i])return l([...a,...n.mode[i]],u("",n.list));throw new Error(`pick("${n.name}") got unknown value: ${String(i)}`)})}return f(o,a,t.list)}function f(e,t,s){let a=(o,n)=>{let i=o?[...t,...S(n)]:t;return s.length===0&&typeof e=="function"?f(c(!0,i),i,s):l(i,u("",s))};return e.$when=a,e.$join=function(n){return a(!0,n)},e}var c=(e,t)=>e?s=>_(t,s):Object.create(null);0&&(module.exports={base,keep,path,pick,root,slot,wrap});
//# sourceMappingURL=api.cjs.map