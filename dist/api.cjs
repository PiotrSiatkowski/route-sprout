"use strict";var S=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var $=Object.getOwnPropertyNames;var w=Object.prototype.hasOwnProperty;var x=(e,t)=>{for(var s in t)S(e,s,{get:t[s],enumerable:!0})},N=(e,t,s,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of $(t))!w.call(e,a)&&a!==s&&S(e,a,{get:()=>t[a],enumerable:!(o=k(t,a))||o.enumerable});return e};var P=e=>N(S({},"__esModule",{value:!0}),e);var R={};x(R,{base:()=>A,keep:()=>b,path:()=>m,pick:()=>j,root:()=>T,slot:()=>D,wrap:()=>C});module.exports=P(R);var p=e=>e.replace(/^-+/,"").replace(/-+$/,"").replace(/^_+/,"").replace(/_+$/,"").replace(/-([a-zA-Z0-9])/g,(t,s)=>s.toUpperCase()).replace(/_([a-zA-Z0-9])/g,(t,s)=>s.toUpperCase()),L=/^[A-Za-z_-][A-Za-z0-9_-]*$/;function g(e,t){if(e==="path"&&t==="")return t.trim();if(!t)throw new Error(`${e} name cannot be empty`);if(!L.test(t))throw new Error(`${e} name "${t}" must be a valid identifier (letters/digits/_/$, not starting with a digit).`);return t.trim()}var h=e=>Array.isArray(e)?e:[e],b=()=>({kind:"keep"}),m=(e,t)=>({kind:"path",name:g("path",e),uuid:p(e),list:t??[]}),D=(e,t)=>({kind:"slot",name:g("slot",e),uuid:`$${p(e)}`,list:t??[]}),C=(e,t,s)=>({kind:"wrap",name:g("wrap",e),uuid:`$${p(e)}`,when:t,list:s??[]}),j=(e,t,s)=>({kind:"pick",name:g("pick",e),uuid:`$${p(e)}`,mode:t,list:s??[]}),A=(e,t)=>({kind:"base",segs:e,list:t??[]}),T=e=>l([],m("",e)),_=e=>{if(e instanceof URLSearchParams)return e.toString();if(typeof e=="string")return e;let t=new URLSearchParams;for(let[s,o]of Object.entries(e))o!=null&&t.append(s,String(o));return t.toString()},O=(e,t)=>`/${e.filter(Boolean).join("/").replace(/\/{2,}/g,"/")}${t?`?${_(t)}`:""}`;function l(e,t){let s=n=>n.list.some(r=>r.kind==="keep"),o=t.kind==="path"&&t.name?[...e,t.name]:e,a=c(s(t),o);for(let n of t.list){if(n.kind!=="keep"&&n.uuid in a)throw new Error(`Duplicate uuid "${String(n.uuid)}" under "${o.join("/")||"/"}"`);if(n.kind==="base"){let r=[...o,...h(n.segs)],d=l(r,m("",n.list));for(let i of Reflect.ownKeys(d)){if(i==="$when"||i==="$join")continue;let u=Object.getOwnPropertyDescriptor(d,i);if(u?.enumerable){if(i in a)throw new Error(`base() merge collision on key "${String(i)}" under "${o.join("/")||"/"}"`);Object.defineProperty(a,i,u)}}}else if(n.kind==="slot")a[n.uuid]=function(d){let i=[...o,d];return n.list.length===0?f(c(!0,i),i,[]):Object.assign(c(s(n),i),l(i,n))};else if(n.kind==="path")if(n.list.length===0){let r=[...o,n.name];a[n.uuid]=f(c(!0,r),r,[])}else a[n.uuid]=l(o,n);else n.kind==="wrap"?a[n.uuid]=function(d){let u=n.when(d)?[...o,n.name]:o,y=l(u,n);return Object.assign(c(s(n),u),y)}:n.kind==="pick"&&(a[n.uuid]=r=>{if(n.mode[r])return l([...o,...n.mode[r]],m("",n.list));throw new Error(`pick("${n.name}") got unknown value: ${String(r)}`)})}return f(a,o,t.list)}function f(e,t,s){let o=(a,n)=>{let r=a?[...t,...h(n)]:t;return s.length===0&&typeof e=="function"?f(c(!0,r),r,s):l(r,m("",s))};return e.$when=o,e.$join=function(n){return o(!0,n)},e}var c=(e,t)=>e?s=>O(t,s):Object.create(null);0&&(module.exports={base,keep,path,pick,root,slot,wrap});
//# sourceMappingURL=api.cjs.map